<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn.jsdelivr.net/gh/cmyk359/MyCDN/Hexo/static/img/webicon.png"><link rel="icon" href="https://cdn.jsdelivr.net/gh/cmyk359/MyCDN/Hexo/static/img/webicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="猫爪在上"><meta name="keywords" content=""><meta name="description" content="一、定义 串 : 即字符串(string)，是由零个或多个字符组成的有限序列。长度为0称为空串。 子串：串中任意个连续的字符组成的子序列成为该串的字串。如S&#x3D;‘Hello World’，中&#39;He&#39;、&#39;Hello&#39;等是子串，而&#39;HW&#39;不是子串，选取时一定要保证连续。 主串：包含子串的串。  字符在串中的位置：字符在串中的序号， 即位序，是从1开始的。 子串在主串中的位置：子串的"><meta property="og:type" content="article"><meta property="og:title" content="四、串"><meta property="og:url" content="https://catpaws.top/dac6dce7/index.html"><meta property="og:site_name" content="猫爪在上de书桌"><meta property="og:description" content="一、定义 串 : 即字符串(string)，是由零个或多个字符组成的有限序列。长度为0称为空串。 子串：串中任意个连续的字符组成的子序列成为该串的字串。如S&#x3D;‘Hello World’，中&#39;He&#39;、&#39;Hello&#39;等是子串，而&#39;HW&#39;不是子串，选取时一定要保证连续。 主串：包含子串的串。  字符在串中的位置：字符在串中的序号， 即位序，是从1开始的。 子串在主串中的位置：子串的"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20230209171011324-2024-12-709:57:46.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20230209171115033-2024-12-709:58:14.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20230209171152346-2024-12-709:58:42.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20230209171240955-2024-12-709:59:03.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/PixPin_2024-12-07_10-36-02-2024-12-710:36:17.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/PixPin_2024-12-07_11-05-33-2024-12-711:05:42.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20241207114745445-2024-12-711:47:46.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20241207115109332-2024-12-711:51:10.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20241207120403971-2024-12-712:04:05.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20241207120731172-2024-12-712:07:32.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20241207120909735-2024-12-712:09:10.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20241207121209271-2024-12-712:12:10.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20241207121236230-2024-12-712:12:37.png"><meta property="og:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20241207121652380-2024-12-712:16:53.png"><meta property="article:published_time" content="2024-12-07T01:42:13.000Z"><meta property="article:modified_time" content="2024-12-07T16:14:52.706Z"><meta property="article:author" content="猫爪在上"><meta property="article:tag" content="串"><meta property="article:tag" content="串的模式匹配"><meta property="article:tag" content="朴素模式匹配"><meta property="article:tag" content="KMP算法"><meta property="article:tag" content="next数组"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://gitee.com/cmyk359/img/raw/master/img/image-20230209171011324-2024-12-709:57:46.png"><title>四、串 - 猫爪在上de书桌</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/cmyk359/MyCDN/Hexo/source/css/font.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/cmyk359/MyCDN/Hexo/source/css/poem.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/shubiao.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"catpaws.top",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:"TNTPv22capMq3aFV9S0sLqSm-gzGzoHsz",app_key:"G2BBAxXmiixopVg5mIJ2sxXR",server_url:"https://tntpv22c.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>猫爪在上de书桌</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-addrcard"></i> <span>主页</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="iconfont icon-books"></i> <span>博客</span></a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/" target="_self"><i class="iconfont icon-pen"></i> <span>文章</span> </a><a class="dropdown-item" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span> </a><a class="dropdown-item" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span> </a><a class="dropdown-item" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></div></li><li class="nav-item"><a class="nav-link" href="/messages/" target="_self"><i class="iconfont icon-comment"></i> <span>留言板</span></a></li><li class="nav-item"><a class="nav-link" href="/timeline/" target="_self"><i class="iconfont icon-images"></i> <span>时光轴</span></a></li><li class="nav-item"><a class="nav-link" href="/links/" target="_self"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(https://cdn.jsdelivr.net/gh/cmyk359/MyCDN/Hexo/static/img/article-bg.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="四、串"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2024-12-07 09:42" pubdate>2024年12月7日 上午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 26 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">四、串</h1><p id="updated-time" class="note note-info">本文最后更新于 2024年12月8日 凌晨</p><div class="markdown-body"><meta name="referrer" content="no-referrer"><h2 id="一定义">一、定义</h2><p><strong>串</strong> : 即字符串(string)，是由零个或多个<u>字符</u>组成的有限序列。长度为0称为空串。</p><p><strong>子串</strong>：串中任意个<u>连续的字符</u>组成的子序列成为该串的字串。如S=‘Hello World’，中'He'、'Hello'等是子串，而'HW'不是子串，选取时一定要<u>保证连续</u>。</p><p><strong>主串</strong>：包含子串的串。</p><ul><li><p>字符在串中的位置：字符在串中的序号， 即<strong>位序</strong>，是从1开始的。</p></li><li><p>子串在主串中的位置：子串的第一个字符在主串中的位置。</p></li></ul><p>前缀：除最后一个字符外，字符串的<strong>所有头部子串</strong>。</p><p>后缀：除第一个字符外，字符串的<strong>所有尾部子串</strong>。</p><blockquote><p>例如 "abad"的前缀为 {"a", "ab", "aba"}，后缀为{"d", "ad", "bad"}</p></blockquote><p>串和线性表的关系：</p><ul><li><p>串是一种特殊的线性表，数据元素之间呈线性关系。</p></li><li><p>串的数据元素限定为字符（如中英文字符，数字，标点字符等），而一般线性表中所存储的数据元素类型不限。</p><blockquote><p>串是内容受限的线性表</p></blockquote></li><li><p>串的基本操作如增删改查等通常以子串为对象，而一般线性表的基本操作时针对其中某个单独元素的。</p></li></ul><p>补：</p><ul><li><p>串的长度是指串中所含字符的个数</p></li><li><p>长度为n的主串有 n-m+1 个长度为m的子串</p></li><li><p>空串是任意串的子串，任意串是其自身的子串</p></li><li><p>长度为n的主串有 n(n+1)/2 + 1个子串，（长度为n的子串有1个，长度为n-1的子串有2个，依次类推是等差数列）</p></li><li><p>非平凡子串：即子串既不为空也不是本身，长度为n的串，有2+3+...+n = (n-1) (n-2) /2个</p></li></ul><h2 id="二串的存储结构">二、串的存储结构</h2><h3 id="顺序存储">2.1、顺序存储</h3><p>类似线性表中的顺序存储，使用一组地址连续的存储单元存储串值的字符序列</p><p>定长顺序存储，使用静态数组</p><div class="code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXLEN 255</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> &#123;
    <span class="hljs-type">char</span> ch[MAXLEN];
    <span class="hljs-type">int</span> length;
&#125;SString;</code></pre></div><p>堆分配存储</p><div class="code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> &#123;
    <span class="hljs-type">char</span> *ch;
    <span class="hljs-type">int</span> length;
&#125;HString;
HString S;
S.ch = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span> (MAXLEN * <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>));
S.length = <span class="hljs-number">0</span>;</code></pre></div><p>串的顺序存储的优缺点和顺序表的类似。</p><p>顺序存储有不同的实现方案：</p><ul><li><p>使用变量length记录当前串长，缺点：字符在串中的位序和在数组中的下标相差一</p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/image-20230209171011324-2024-12-709:57:46.png" srcset="/img/loading.gif" lazyload alt="image-20230209171011324" style="zoom:80%"></p></li><li><p>ch[0]充当length，优点是字符的位序和数组下标相同，但由于一个字符为1B，所能表示的最大数字为255，能记录的范围有限</p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/image-20230209171115033-2024-12-709:58:14.png" srcset="/img/loading.gif" lazyload alt="image-20230209171115033" style="zoom:80%"></p></li><li><p>不设置length变量，以字符'\0'表示结尾，缺点：想知道当前串长需要从头遍历。</p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/image-20230209171152346-2024-12-709:58:42.png" srcset="/img/loading.gif" lazyload alt="image-20230209171152346" style="zoom:80%"></p></li><li><p>舍弃ch[0]不用，让字符位序和数组下标保持一致，同时设置length变量记录串长。<推荐></推荐></p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/image-20230209171240955-2024-12-709:59:03.png" srcset="/img/loading.gif" lazyload alt="image-20230209171240955" style="zoom:80%"></p></li></ul><h3 id="串的链式存储">2.2、串的链式存储</h3><p>类似于线性表的链式存储结构，其中每个结点既可以存放一个字符，也可以存放多个字符。每个结点称为块，整个链表称为块链结构</p><h2 id="三串的基本操作">三、串的基本操作</h2><p>串赋值 StrAssign、串比较 StrCompare、 求串长 StrLength、串连接 Concat 及求子串SubString，这五种操作构成串类型的最小操作集，其他串操作均可在该最小操作集上实现。</p><div class="code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//清空子串,S.length = 0;</span>
<span class="hljs-built_in">ClearString</span>(&amp;S); 

<span class="hljs-comment">//求子串，用sub返回S的第pos个字符起长度为len的子串</span>
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">SubString</span><span class="hljs-params">(SString &amp;sub, SString s, <span class="hljs-type">int</span> pos, <span class="hljs-type">int</span> len)</span> </span>&#123;
    <span class="hljs-keyword">if</span> (pos + len - <span class="hljs-number">1</span> &gt; s.length) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">//子串范围越界</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = pos; i &lt; pos + len; i++)
        sub[i - pos + <span class="hljs-number">1</span>] = s[i];
    sub.length = len;
    retrun <span class="hljs-literal">true</span>;
&#125;

<span class="hljs-comment">//串比较。S&gt;T,返回值&gt;0;S&lt;T,返回值&lt;0;S=T,返回值=0;</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">StrCompare</span><span class="hljs-params">(SString S, SString T)</span> </span>&#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= S.length &amp;&amp; i &lt; T.length; i++) 
        <span class="hljs-keyword">if</span> (S[i] != T[i])
            <span class="hljs-keyword">return</span> S[i] - T[i];
    <span class="hljs-keyword">return</span> S.length - T.length;
&#125;

<span class="hljs-comment">//子串定位，若串S中存在与串T值相同的子串，返回该子串在串S中第一次出现的位置。</span>
<span class="hljs-comment">//结合取子串和串比较，每次从S中取出和T长度相同的子串，和T比较</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">index</span><span class="hljs-params">(SString S, SString T)</span> </span>&#123;
    <span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, n = S.length, m = T.length;
    SString Sub;
    <span class="hljs-keyword">while</span> (i &lt; n - m + <span class="hljs-number">1</span>) &#123;
        <span class="hljs-built_in">SubString</span>(sub,S,i,m);
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">StrCompare</span>(sub, T) != <span class="hljs-number">0</span>)
            i++;
        <span class="hljs-keyword">else</span> 
            retrun i;      
    &#125;
    retrun <span class="hljs-number">0</span>; <span class="hljs-comment">//不存在该子串</span>
&#125;</code></pre></div><h2 id="四串的模式匹配">四、串的模式匹配</h2><p>一些概念</p><ul><li>主串</li><li>子串,<一定是主串中存在的才叫子串></一定是主串中存在的才叫子串></li><li>模式串, &lt;想尝试在主串中找的串，未必存在&gt;</li></ul><p><strong>串的模式匹配：在主串中找到与模式串相同的子串，并返回位置。即子串的定位操作。</strong></p><h3 id="朴素模式匹配算法">4.1、朴素模式匹配算法</h3><p>思想：依次从主串中找出一个和模式串长度相同的子串，对所取子串和模式串中的元素依次比较，直到找到一个完全匹配的子串，或所有子串都不匹配为止。</p><p>算法分析：若模式串长度为m，主串长度为n。</p><ul><li><p>匹配成功的最好时间复杂度：<em>O</em>(m)，主串的第一个长度为m的子串就和模式串完全匹配。</p></li><li><p>匹配失败的最好情况：每个子串的第一个字符不匹配，其时间复杂度为 <em>O</em>(n-m+1)≈<em>O</em>(n)</p><blockquote><p>长度为m的子串有n-m+1个，故时间复杂度为<em>O</em>(n-m+1)</p></blockquote></li><li><p>最坏时间复杂度：<em>O</em>(mn)</p><ul><li>最坏情况是，对主串的n-m+1个长度为m的子串，每次对比时前m-1个字符都匹配，但第m个字符不匹配，其中共对比 m* (n-m+1)次，时间复杂度为 <em>O</em>(mn)</li><li>此时主串指针每次都要发生回溯</li></ul></li></ul><h3 id="kmp算法">4.2、KMP算法</h3><p>由于朴素模式匹配算法在某些子串和模式串只能部分匹配时，主串的扫描指针i经常发生回溯，导致时间开销增加，其最坏时间复杂度为<em>O</em>(mn)。</p><p>​ KMP算法要利用之前部分成功匹配的信息，<strong>当子串和模式串不能匹配时，主串的扫描指针不回溯，只移动模式串的扫描指针j到一个合适的位置next[j]后，再次开始比较</strong>，其中模式串指针应跳到的位置保存在next数组中，算法平均时间复杂度为<em>O</em>(m+n),其中计算next数组为O(m),匹配需要O(n)。</p><p>next数组手算方法：当模式串中第j个字符匹配失败时，假设由模式串前j-1个字符组成的串为S，</p><p>则 <strong>next[j] = S的最长相等前后缀 + 1</strong>，其中next数组第一位和第二位一定是0和1</p><blockquote><ol type="1"><li>next[j]的值只与当前位置之前的模式串结构相关，与主串无关，每个位置对应一个next[j]</li><li>next[0] 不用，next[1] = 0 是规定</li><li>next[j]的值每次最多增加1</li><li>模式串的最后一位字符不影响next数组的结果</li></ol></blockquote><p>KMP算法只有子串和模式串有很多部分成功匹配时才显得比朴素模式匹配算法快。</p><h3 id="kmp算法优化nextval数组">4.3、KMP算法优化：nextval数组</h3><p>当子串和模式串不匹配时，j = nextval[j]。</p><p>若模式串第j个位置的字符和子串匹配失败时，根据KMP算法，让j = next[j] 继续比较。但当next[j]位置所指的字符和第j个位置的字符相同，那么比较必然失败，这次比较就没有意义。</p><blockquote><p>如果出现这种情况，则需要再次递归，将next[j]的值修正为next[next[j]]，直至两者不相等或到达初始条件为止</p></blockquote><p>求nextval数组：</p><ul><li>求next数组</li><li>nextval[1] = 0,从左向右依次求：<ul><li>若next[j]位置的字符和当前字符相同，则nextval数组对应的值也相同，即 nextval[j] = nextval[ next[j] ]</li><li>若next[j]位置的字符和当前字符不同，则保持不变，即 nextval[j] = next[j]</li></ul></li></ul><h3 id="代码实现求next数组">4.4、代码实现求next数组</h3><p>用代码实现求next数组，核心是由next[j]求next[j+1]。</p><p>由定义next[1] = 0，设next[j] = k，则 <span class="math inline">\(1 &lt;k&lt;j\)</span>，且满足 <span class="math inline">\(p_1 ...p_{k-1} = p_{j-k+1}...p_{j-1}\)</span>，这两个子串是相同的。</p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/PixPin_2024-12-07_10-36-02-2024-12-710:36:17.png" srcset="/img/loading.gif" lazyload alt="image-20230209171011324" style="zoom:80%"></p><p>则 next[j + 1] ：即<strong>找最长相等前后缀长度，再加一</strong>。</p><ol type="1"><li><p>若 <span class="math inline">\(p_k = p_j\)</span>，则以<span class="math inline">\(p_{j+1}\)</span>为结尾的子串的最长相等前后缀长度为 k，故<span class="math inline">\(next[j+1] = k +1=next[j]+1\)</span>&lt;<u>最好的情况</u>&gt;</p></li><li><p>若 <span class="math inline">\(p_k \neq p_j\)</span>，此时看作模式串作为子串与自身在与第k位匹配失败，应继续将<span class="math inline">\(p_{next[k]}\)</span>和<span class="math inline">\({p_j}\)</span>相比较</p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/PixPin_2024-12-07_11-05-33-2024-12-711:05:42.png" srcset="/img/loading.gif" lazyload alt="image-20230209171011324" style="zoom:80%"></p><p>分析：在<span class="math inline">\(p_1\;...\;p_{k-1}\)</span>中被划分出两个长度为 next[k]-1的前后缀，由于前后两个大的前后缀相同，由于对称性，故在后面对应位置也划分出了两个长度为next[k] -1的前后缀。</p><p>​ 即此时在<span class="math inline">\(p_1\;...\;p_{j-1}\)</span>中有四个长度为next[k] - 1的相等子串。为求next[j+1]只关心最前和最后两个子串，若它们各自的下一位字符相等，即<span class="math inline">\({p_{next[k]}} = p_j\)</span>，则前j个字符的最长相等前后缀为next[k]，故next[j+1] = next[k] + 1；若各自的下一位字符不相等，即<span class="math inline">\({p_{next[k]}} \neq p_j\)</span>，则继续划分下去，重复以上的判断，直至相等或到达初始条件 next[1] = 0。</p><blockquote><p>不管被划分成n个相等长度的相同子串，都只看最前面和最后面两个子串的下一位字符是否相等，即可确定最长相等前后缀长度，进而确定next[j+1]。</p></blockquote></li></ol><p>总结上述规律得：</p><ul><li>若<span class="math inline">\(p_{next[k]} = p_j\)</span>，则next[j+1] = next[k] + 1;</li><li>若<span class="math inline">\(p_{next[k]} \neq p_j\)</span>，则重复划分直至相等或到达初始条件next[1] =0 为止。</li></ul><div class="code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//实现求next数组</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">get_index</span><span class="hljs-params">(SString p, <span class="hljs-type">int</span> next[])</span> </span>&#123;
    <span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, j = <span class="hljs-number">0</span>;
    next[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (i &lt;= <span class="hljs-built_in">StrLength</span>(p)) &#123;
        <span class="hljs-keyword">if</span> (j == <span class="hljs-number">0</span> || p[i] == p[j]) &#123;
            ++i;
            ++j;
            next[i] = j; <span class="hljs-comment">// 简写为 next[++i] = ++j;</span>
        &#125;<span class="hljs-keyword">else</span> &#123;
            j = next[j];
        &#125;
    &#125;
&#125;</code></pre></div><h2 id="五广义表">五、广义表</h2><h3 id="定义">5.1、定义</h3><p>广义表是线性表的推广，一般记作<span class="math inline">\(LS = (a_1,a_2\;...\;a_n), n\geq 0\)</span>。<span class="math inline">\(LS\)</span>是广义表<span class="math inline">\((a_1,a_2\;...\;a_n)\)</span>的名称，n是其长度。</p><p><span class="math inline">\(a_i\)</span>可以是单元素（<u>原子</u>），也可以是广义表（<u>子表</u>），广义表的定义是递归的。</p><p>任何非空广义表<span class="math inline">\(LS = (a_1,a_2\;...\;a_n)\)</span>均可分解为<strong>表头</strong>和<strong>表尾</strong>两部分：</p><ul><li>表头(Head)：第一个元素，<span class="math inline">\(Head(LS) = a_1\)</span>。</li><li>表尾(Tail)：出第一个元素外，<u>其余元素构成的表</u>，<span class="math inline">\(Tail(LS) = (a_2,a_3\;...\;a_n)\)</span>。</li></ul><p>例如：</p><ul><li><span class="math inline">\(D=(E,F) = (a,(b,c),F)\)</span>，<span class="math inline">\(Head(D) = E\)</span>，<span class="math inline">\(Head(E) = a\)</span>，<span class="math inline">\(Tail(E) = ((b, c))\)</span></li><li><span class="math inline">\(Head((b,c)) = b\)</span>，<span class="math inline">\(Tail((b,c)) = (c)\)</span></li><li><span class="math inline">\(Head(((b,c))) = (b,c)\)</span>，<span class="math inline">\(Tail(((b,c))) = ()\)</span></li><li><span class="math inline">\(C = (a,(b,c,d))\)</span>，<span class="math inline">\(Head(C) = a\)</span>，<span class="math inline">\(Tail(C) = ((b,c,d))\)</span></li></ul><h3 id="特点">5.2、特点</h3><ol type="1"><li>广义表中元素有相对次序。</li><li>广义表的<strong>长度</strong>定义为表中元素的个数。</li><li>广义表的<strong>深度</strong>定义为表的嵌套层数。</li><li>广义表可以改共享，即一个广义表可以作为其他表的子表。</li><li>广义表是一个递归的表。</li></ol><blockquote><p>注：</p><ol type="1"><li>原子的深度为0，空表的深度为1。</li><li>递归表的长度是有限值，深度是无穷值。</li></ol></blockquote><p>例如：</p><ul><li><span class="math inline">\(A=()\)</span>，A是一个空表，长度为0，深度为1</li><li><span class="math inline">\(B=(e)\)</span>，B只有一个原子，长度为1，深度为1</li><li><span class="math inline">\(C=(a,(b,c,d))\)</span>，C有一个原子和一个子表，长度为2，深度为2</li><li><span class="math inline">\(D=(A,B,C)\)</span>，D有三个子表，长度为3，深度为3</li><li><span class="math inline">\(E=(a,E)\)</span>，E是一个递归的表，长度为2，深度为无穷大</li></ul><h3 id="广义表的存储结构">5.3、广义表的存储结构</h3><p>通常采用链式存储结构，常用的有两种：头尾链表的存储结构 和 扩展线性链表的存储结构。</p><ul><li><p>头尾链表的存储结构</p><p>表结点：<img src="https://gitee.com/cmyk359/img/raw/master/img/image-20241207114745445-2024-12-711:47:46.png" srcset="/img/loading.gif" lazyload alt="image-20241207114745445" style="zoom:67%"></p><ul><li>hp所指的或为表结点，或为原子结点</li><li>除非表尾为空，则tp指针为空，<u>否则必指向表节点</u></li></ul><p>原子结点：<img src="https://gitee.com/cmyk359/img/raw/master/img/image-20241207115109332-2024-12-711:51:10.png" srcset="/img/loading.gif" lazyload alt="image-20241207115109332" style="zoom:67%"></p><p>例如：</p><ul><li><p><span class="math inline">\(C=(a,(b,c,d))\)</span></p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/image-20241207120403971-2024-12-712:04:05.png" srcset="/img/loading.gif" lazyload alt="image-20241207120403971" style="zoom:67%"></p></li><li><p><span class="math inline">\(E=(a,E)\)</span></p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/image-20241207120731172-2024-12-712:07:32.png" srcset="/img/loading.gif" lazyload alt="image-20241207120731172" style="zoom:67%"></p></li><li><p><span class="math inline">\(B=(e)\)</span></p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/image-20241207120909735-2024-12-712:09:10.png" srcset="/img/loading.gif" lazyload alt="image-20241207120909735" style="zoom:67%"></p></li></ul></li><li><p>扩展线性表的存储结构</p><p>无论是表结点还是原子结点均由三个域构成</p><p>表结点：<img src="https://gitee.com/cmyk359/img/raw/master/img/image-20241207121209271-2024-12-712:12:10.png" srcset="/img/loading.gif" lazyload alt="image-20241207121209271" style="zoom:67%"></p><p>原子结点：<img src="https://gitee.com/cmyk359/img/raw/master/img/image-20241207121236230-2024-12-712:12:37.png" srcset="/img/loading.gif" lazyload alt="image-20241207121236230" style="zoom:67%"></p></li></ul><p>例如：<span class="math inline">\(C=(a,(b,c,d))\)</span></p><p><img src="https://gitee.com/cmyk359/img/raw/master/img/image-20241207121652380-2024-12-712:16:53.png" srcset="/img/loading.gif" lazyload alt="image-20241207121652380" style="zoom:67%"></p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="category-chain-item">数据结构</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/%E4%B8%B2/" class="print-no-link">#串</a> <a href="/tags/%E4%B8%B2%E7%9A%84%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/" class="print-no-link">#串的模式匹配</a> <a href="/tags/%E6%9C%B4%E7%B4%A0%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/" class="print-no-link">#朴素模式匹配</a> <a href="/tags/KMP%E7%AE%97%E6%B3%95/" class="print-no-link">#KMP算法</a> <a href="/tags/next%E6%95%B0%E7%BB%84/" class="print-no-link">#next数组</a></div></div><div class="license-box my-3"><div class="license-title"><div>四、串</div><div>https://catpaws.top/dac6dce7/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>猫爪在上</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2024年12月7日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/453281de/" title="五、树和二叉树"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">五、树和二叉树</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/d403458d/" title="三、栈和队列"><span class="hidden-mobile">三、栈和队列</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="twikoo"></div><script type="text/javascript">Fluid.utils.loadComments("#comments",(function(){Fluid.utils.createScript("https://cdn.smartcis.cn/npm/twikoo@1.6.40/dist/twikoo.all.min.js",(function(){var t=Object.assign({envId:"https://catpaws-comments.netlify.app/.netlify/functions/twikoo",region:"ap-shanghai",path:"window.location.pathname"},{el:"#twikoo",path:"window.location.pathname",onCommentLoaded:function(){Fluid.utils.listenDOMLoaded((function(){var t="#twikoo .tk-content img:not(.tk-owo-emotion)";Fluid.plugins.imageCaption(t),Fluid.plugins.fancyBox(t)}))}});twikoo.init(t)}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><script>Fluid.utils.createScript("https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js",(function(){mermaid.initialize({theme:"default"}),Fluid.utils.listenDOMLoaded((function(){Fluid.events.registerRefreshCallback((function(){"mermaid"in window&&mermaid.init()}))}))}))</script><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a><br>人山人海，欢迎你的到来 <i class="iconfont icon-love"></i><br><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script>window.MathJax?(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset(),MathJax.typesetPromise()):window.MathJax={tex:{inlineMath:{"[+]":[["$","$"]]}},loader:{load:["ui/lazy"]},options:{renderActions:{insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(t=>{let e=t.parentNode;"li"===e.nodeName.toLowerCase()&&e.parentNode.classList.add("has-jax")})},"",!1]}}},Fluid.events.registerRefreshCallback((function(){"MathJax"in window&&MathJax.startup.document&&"function"==typeof MathJax.startup.document.state&&(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset(),MathJax.typesetPromise())}))</script><script src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><script defer src="/js/leancloud.js"></script><script src="/js/local-search.js"></script><script src="//cdn.jsdelivr.net/gh/cmyk359/MyCDN/Hexo/source/js/timeDate.js"></script><script src="//sdk.jinrishici.com/v2/browser/jinrishici.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript><script data-pjax src="https://unpkg.com/oh-my-live2d"></script><script>const oml2d=OML2D.loadOml2d({dockedPosition:"left",mobileDisplay:!1,models:[{path:"http://img.catpaws.top/blog-source/live2d/Frieren/Frieren.model3.json",motionPreloadStrategy:"IDLE",position:[-60,-100],scale:.06,stageStyle:{width:250,height:350}}],parentElement:document.body,primaryColor:"var(--btn-bg)",sayHello:!1,tips:{style:{width:200,height:90,left:"calc(50% - 20px)",top:"-100px","font-size":"14px"},idleTips:{interval:15e3,message:function(){return axios.get("https://v1.hitokoto.cn?c=i").then((function(t){return t.data.hitokoto})).catch((function(t){console.error(t)}))}}}})</script></body></html>